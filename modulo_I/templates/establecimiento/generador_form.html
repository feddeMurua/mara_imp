{% extends "base/base_forms.html" %}
{% load staticfiles %}
{% load staticfiles bootstrap3 %}
{% load widget_tweaks %}


{% block stylesheets %}
  {{block.super}}
  <link rel="stylesheet" href="{% static 'css/bootstrap-timepicker.min.css' %}"/>
{% endblock %}

{% block scripts %}
  {{block.super}}
  <script type="text/javascript" src="{% static 'js/bootstrap-timepicker.min.js' %}"></script>
{% endblock %}

{% block title %}Generador{% endblock %}

{% block header-title %} Información de Generador{% endblock %}

{% block step-form %}


  <div class="form-section">
   <div class="panel panel-default">
     <div class="panel-heading">HORARIO DE ATENCIÓN</div>
     <div class="panel-body">
       {{horario_atencion_formset.management_form}}
       {% for form in horario_atencion_formset %}
        <div class='form'>
          <div class="panel panel-default">
            <div class="panel-body">
               <fieldset class='no_error'>
                 <leyend><strong>(*)Día:</strong></leyend>
                 {{form.dia|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo día es obligatorio"}}
                 <br>
                 <leyend><strong>TURNO MAÑANA</strong></leyend>
                 <br>
                 <leyend><strong>Desde:</strong></leyend>
                 {{form.hora_desde_m|add_class:"form-control"|attr:"type:range"|attr:"data-parsley=range=[6, 10]"}}
                 {% for error in form.hora_desde_m.errors %}
                  <span style="color:red;" class="help-block">{{ error }}</span>
                 {% endfor %}
                 <br>
                 <leyend><strong>Hasta:</strong></leyend>
                 {{form.hora_hasta_t|add_class:"form-control"}}
                 {% for error in form.hora_hasta_t.errors %}
                  <span style="color:red;" class="help-block">{{ error }}</span>
                 {% endfor %}
                 <br>
                 <leyend><strong>TURNO TARDE</strong></leyend>
                 <br>
                 <leyend><strong>Desde:</strong></leyend>
                 {{form.hora_desde_t|add_class:"form-control"}}
                 {% for error in form.hora_desde_t.errors %}
                  <span style="color:red;" class="help-block">{{ error }}</span>
                 {% endfor %}
                 <br>
                 <leyend><strong>Hasta:</strong></leyend>
                 {{form.hora_hasta_t|add_class:"form-control"}}
                 {% for error in form.hora_hasta_t.errors %}
                  <span style="color:red;" class="help-block">{{ error }}</span>
                 {% endfor %}
                 <br>
                 <leyend><strong>(*)Horario de Retiro:</strong></leyend>
                 {{form.horario_retiro|add_class:"form-control"|attr:"required:"}}
                 {% for error in form.horario_retiro.errors %}
                  <span style="color:red;" class="help-block">{{ error }}</span>
                 {% endfor %}
                 <br>
                 <leyend><strong>CANCELAR FORMULARIO ACTUAL</strong></leyend>
                 {{form.DELETE}}
                 <br>
               </fieldset>
             </div>
           </div>
        </div>
        {% endfor %}
        <br>
        <button id="add_more" type="button" class="btn btn-success">
          <span class="glyphicon glyphicon-plus"></span>
        </button>

     </div>
   </div>

   <script>
      $('#add_more').click(function() {
          cloneMore('div.form:last', 'service');
      });

      /* Alta form*/
      function cloneMore(selector, type) {
        var newElement = $(selector).clone(true);
        var total = $('#id_' + type + '-TOTAL_FORMS').val();
        newElement.find(':input').each(function() {
            var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
            var id = 'id_' + name;
            $(this).attr({'name': name, 'id': id}).val('').removeAttr('checked');
        });
        newElement.find('label').each(function() {
            var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');
            $(this).attr('for', newFor);
        });
        total++;
        $('#id_' + type + '-TOTAL_FORMS').val(total);
        $(selector).after(newElement);
      }

    </script>
  </div>

<!--
  <div class="form-section">
   <div class="panel panel-default">
     <div class="panel-heading">TIPO Y CANTIDAD DE RESIDUOS GENERADOR</div>
     <div class="panel-body">

     </div>
   </div>
  </div>
-->

  <div class="form-section">
     <div class="panel panel-default">
       <div class="panel-heading">TIPO DE ACTIVIDAD</div>
         <div class="panel-body">
           <label>(*)Tipo de actividad:</label>
           {{actividades_form.tipo_actividad|attr:"required:"|attr:"data-parsley-error-message:(*)Seleccione al menos un tipo de actividad del centro generador"}}
           <br>
         </div>
     </div>
   </div>

<!--

  <div class="form-section">
      <div class="panel panel-default">
        <div class="panel-heading">DATOS DEL CENTRO GENERADOR</div>
          <div class="panel-body">
            <div class="form-group">
              <label>(*)Director Responsable:</label>
              {{generador_form.director_responsable|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo director responsable es obligatorio"}}
              <br>
              <label>(*)Responsable Residuos:</label>
              {{generador_form.responsable_residuos|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo responsable de residuos es obligatorio"}}
              <a class="btn btn-success js-alta-persona" >
                <span class="glyphicon glyphicon-plus"></span>
              </a>
              <br><br>
              <label>(*)Responsable Suplentes Residuos:</label>
              {{generador_form.responsable_suplente|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo director responsable suplente de residuos es obligatorio"}}
              <a class="btn btn-success js-alta-persona" >
                <span class="glyphicon glyphicon-plus"></span>
              </a>
              <br><br>
              <label>(*)Responsable Técnico:</label>
              {{generador_form.responsable_tecnico|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo responsable técnico es obligatorio"}}
              <a class="btn btn-success js-alta-persona" >
                <span class="glyphicon glyphicon-plus"></span>
              </a>
              <br><br>
              <label>(*)Fecha vínculo:</label>
              {{generador_form.fecha_vinculo|add_class:'form-control'|attr:"readonly"|attr:"style:background:white"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo fecha vínculo es obligatorio"}}
              <br>
              <label>(*)Número de Inscripción en el Registro de Generadores Provincia del Chubut:</label>
              {{generador_form.nro_inscripcion|add_class:'form-control'|attr:"required:"|attr:"type:number"|attr:"data-parsley-type=integer"|attr:"data-parsley-error-message:(*)El campo N° inscripción es obligatorio"}}
              <br>
              <label>(*)Razón Social:</label>
              {{generador_form.razon_social|add_class:'form-control'|attr:"required:"|attr:"data-parsley-error-message:(*)El campo razón social es obligatorio"}}
              <br>
              <label>(*)Teléfono:</label>
              {{generador_form.telefono|add_class:'form-control'|attr:"required:"|attr:"data-parsley-error-message:(*)El campo teléfono es obligatorio"}}
              <br>
              <label>Correo Electrónico:</label>
              {{generador_form.email|add_class:'form-control'|attr:"type:email"|attr:"data-parsley-type=email"|attr:"data-parsley-error-message:(*)Formato de correo incorrecto"}}
              <br>
              <label>Observaciones/Comentarios:</label>
              {{generador_form.observaciones_comentarios|add_class:'form-control'}}
              <br>
              <label>(*)Número de Sector Asociado:</label>
              {{generador_form.sector|add_class:'form-control'|attr:"required:"|attr:"type:number"|attr:"data-parsley-type=integer"|attr:"data-parsley-error-message:(*)El campo sector es obligatorio"}}
              <br>
            </div>
          </div>
        </div>
    </div>

  <div class="form-section">
     <div class="panel panel-default">
       <div class="panel-heading">SECTOR DE ACOPIO TRANSITORIO EN EL CENTRO GENERADOR</div>
         <div class="panel-body">
           <div class="form-group">
             {{ acopio_transitorio_form.camara_frio|attr:"class:camara_frio"|attr:"name:camara_frio"|attr:"onchange:valueChanged()"}}
             <label>Cámara de Frío</label>
             <br>
             <div class="dimension_camara_frio" style="display:none">
               <label>Dimensión cámara de frío</label>
               {{ acopio_transitorio_form.dimension_camara_frio|add_class:'form-control'}}
               <br><br>
             </div>
             {{ acopio_transitorio_form.sector_interno_p_estacionar|attr:"class:sector_interno"|attr:"name:sector_interno"|attr:"onchange:valueChanged()"}}
             <label>Sector interno p/estacionar</label>
             <br>
             <div class="dimension_sector_interno" style="display:none">
               <label>Dimensión del sector de acopio</label>
               {{ acopio_transitorio_form.dimension_sector|add_class:'form-control'}}
               <br>
             </div>
           </div>
           <label>(*)Vía de Acceso al sector de acopio:</label>
           {{via_acceso_form.tipo|attr:"required:"|attr:"data-parsley-error-message:(*)Seleccione al menos una vía de acceso al sector de acopio"}}
         </div>
     </div>
   </div>

  <div class="form-section">
     <div class="panel panel-default">
       <div class="panel-heading">ÁMBITO/DEPENDENCIA</div>
         <div class="panel-body">
           <label>(*)Categoría:</label>
           {{ambito_dpcia_form.categoria|add_class:"select-2"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo Categoría es obligatorio"}}
           <br>
           <label>Municipalidad:</label>
           {{ambito_dpcia_form.municipalidad|add_class:'form-control'}}
           <br>
           <label>Nombre del centro del que depende:</label>
           {{ambito_dpcia_form.centro_que_depende|add_class:'form-control'}}
       </div>
     </div>
   </div>

  <div class="form-section">
     <div class="panel panel-default">
       <div class="panel-heading">CARACTERÍSTICAS GENERALES DEL CENTRO DE ATENCIÓN</div>
         <div class="panel-body">
           <label>(*)Cantidad de Quirófanos:</label>
           {{caract_generales_form.cant_quirofanos|add_class:'form-control'|attr:"required:"|attr:"data-parsley-error-message:(*)El campo Cantidad de quirófanos es obligatorio"}}
           <br>
           <label>(*)N° de camas:</label>
           {{caract_generales_form.nro_camas|add_class:'form-control'|attr:"type:number"|attr:"data-parsley-type=integer"|attr:"required:"|attr:"data-parsley-error-message:(*)El campo N° de camas es obligatorio"}}
           <br>
           <label>(*)Población promedio antendida (al mes):</label>
           {{caract_generales_form.poblacion_promedio_atendida|add_class:'form-control'|attr:"required:"|attr:"data-parsley-error-message:(*)El campo Población promedio atendido es obligatorio"}}
           <br>
           <label>(*)Población promedio antendida (al año):</label>
           {{caract_generales_form.poblacion_promedio_atendida_365|add_class:'form-control'|attr:"required:"|attr:"data-parsley-error-message:(*)El campo Población promedio atendido al año es obligatorio"}}
           <br>
           <label>(*)Vía de Acceso al centro generador:</label>
           {{caract_generales_form.via_acceso|attr:"required:"|attr:"data-parsley-error-message:(*)Seleccione al menos una vía de acceso al centro generador"}}
           <br>
       </div>
     </div>
   </div>

 -->


  <script type="text/javascript">

    // Función para el checkbox del formulario de sector de acopio transitorio
    function valueChanged()
    {
        if($('.camara_frio').is(":checked"))
            $(".dimension_camara_frio").show();
        else
            $(".dimension_camara_frio").hide();

        if($('.sector_interno').is(":checked"))
            $(".dimension_sector_interno").show();
        else
            $(".dimension_sector_interno").hide();
    }

    // timepicker para los campos requeridos
    //$('.hs_timepicker').timepicker();

  </script>
{% endblock %}

{% block no-domicilio-step-form%}
{% endblock %}

{% block url-cancelar %}
  {% url 'generadores:listado_generadores' %}
{% endblock %}
